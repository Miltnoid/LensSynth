\input{macros}



\documentclass{article}
\usepackage{amsmath}
\usepackage{mathpartir}
\usepackage{empheq}
\begin{document}

\begin{mathpar}
\inferrule[Identity Atom Lens Base]
{
}
{
\Delta \cup \{(\Regex,\UserDefined)\} \vdash \IdentityLens : \UserDefined \Leftrightarrow \UserDefined
}

\inferrule[Identity Lens AddExample]
{
\Delta \cup \{(\Regex,\UserDefined)\} \vdash
\IdentityLens : (\UserDefined,\StringList_1,\ExampleNumberListList_1) \Leftrightarrow (\UserDefined,\StringList_2,\ExampleNumberListList_2)\\
\Delta \vdash \String : \Regex\\
}
{
\Delta \cup \{(\Regex,\UserDefined)\} \vdash
\IdentityLens : (\UserDefined,\String::\StringList_1,\ExampleNumberList::\ExampleNumberListList_1) \Leftrightarrow (\UserDefined,\String::\StringList_2,\ExampleNumberList::\ExampleNumberListList_2)\\
}

\inferrule[Iterate Atom Lens]
{
\Delta \vdash \DNFLens : (\DNFRegex_1,\ExampleNumberListList_1) \Leftrightarrow (\DNFRegex_2,\ExampleNumberListList_2)\\
\ValidCombine{\Combine}{\ExampleNumberListList_1}\\
\ValidCombine{\Combine}{\ExampleNumberListList_2}\\
\DNFRegex_1^{!*}\\
\DNFRegex_2^{!*}\\
}
{
\Delta \vdash \IterateLens{\DNFLens} : (\Star{(\DNFRegex_1,\ExampleNumberListList_1)},\CombineList{\ExampleNumberListList_1}) \Leftrightarrow (\Star{(\DNFRegex_2,\ExampleNumberListList_2)},\CombineList{\ExampleNumberListList_2})
}

\inferrule[Clause Lens]
{
\Delta \vdash \AtomLens_1 : (\Atom_{1,1},\ExampleNumberListList_1) \Leftrightarrow (\Atom_{1,2},\ExampleNumberListList_2)\\
\ldots\\
\Delta \vdash \AtomLens_n : (\Atom_{n,1},\ExampleNumberListList_1) \Leftrightarrow (\Atom_{n,2},\ExampleNumberListList_2)\\
\Atom_{i,j} .! \Atom_{i+1,j}\\
}
{
\Delta \vdash ([\AtomLens_1;\ldots;\AtomLens_n],[\String_{1,1};\ldots;\String_{n+1,1}],[\String_{1,2};\ldots;\String_{n+1,2}],\sigma) : ([(\Atom_{1,1},\ExampleNumberListList_1);\ldots;(\Atom_{n,1},\ExampleNumberListList_1)],[\String_{1,1};\ldots;\String_{n+1,1}],\ExampleNumberListList_1) \Leftrightarrow ([(\Atom_{\sigma^{-1}(1),2},\ExampleNumberListList_2);\ldots;(\Atom_{\sigma^{-1}(n),2},\ExampleNumberListList_2)],[\String_{1,2};\ldots;\String_{n+1,2}],\ExampleNumberListList_2)
}

\inferrule[DNF Regex Lens]
{
\Delta \vdash \ClauseLens_1 : (\Clause_{1,1},\ExampleNumberListList_{1,1}) \Leftrightarrow (\Clause_{1,2},\ExampleNumberListList_{1,2})\\
\ldots\\
\Delta \vdash \ClauseLens_n : (\Clause_{n,1},\ExampleNumberListList_{n,1}) \Leftrightarrow (\Clause_{n,2},\ExampleNumberListList_{n,2})\\
\Clause_{i} \cap \Clause_{j}=\emptyset\\
\ExampleNumberListList_{i_1,j} \cap \ExampleNumberListList_{i_2,j} = \emptyset\\
}
{
\Delta \vdash ([\ClauseLens_1;\ldots;\ClauseLens_n],\sigma) : ([(\Clause_{1,1},\ExampleNumberListList_{1,1});\ldots;(\Clause_{n,1},\ExampleNumberListList_{n,1})],\NAryInterleave{\ExampleNumberListList_{1,1}}{\ExampleNumberList_{n,1}}) \Leftrightarrow ([(\Clause_{\sigma^{-1}(1),2},\ExampleNumberListList_{\sigma^{-1}(1),2});\ldots;(\Clause_{\sigma^{-1}(n),2},\ExampleNumberListList_{\sigma^{-1}(n),2})],\NAryInterleave{\ExampleNumberListList_{\sigma^{-1}(1),2}},{\ExampleNumberListList_{\sigma^{-1}(n),2}})
}
\end{mathpar}


\end{document}
