\begin{figure}
\begin{mathpar}
\inferrule[Identity Atom Lens]
{
}
{
\Delta \vdash \IdentityLens : \UserDefined \Leftrightarrow \UserDefined
}

\inferrule[Iterate Atom Lens]
{
\Delta \vdash \DNFLens : \DNFRegex_1 \Leftrightarrow \DNFRegex_2\\
\UnambigIt{\LanguageOf{\Delta}{\DNFRegex_1}}\\
\UnambigIt{\LanguageOf{\Delta}{\DNFRegex_2}}\\
}
{
\Delta \vdash \IterateLens{\DNFLens} : \Star{\DNFRegex_1} \Leftrightarrow \Star{\DNFRegex_2}
}

\inferrule[Clause Lens]
{
\lambda i:\RangeIncInc{1}{n}.(\Delta \vdash \AtomLens_i : \Atom_i \Leftrightarrow \AtomAlt_i)\\
\sigma \in \RangeIncInc{1}{n} \rightarrowtail \RangeIncInc{1}{n}\\
\UnambigConcat{\LanguageOf{\Delta}{\String_{i-1}\Atom_i\epsilon}}{\LanguageOf{\Delta}{\String_i\Atom_{i+1}\epsilon}}\\
\UnambigConcat{\LanguageOf{\Delta}{\StringAlt_{i-1}\AtomAlt_{\sigma(i)}\epsilon}}{\LanguageOf{\Delta}{\StringAlt_i\AtomAlt_{\sigma(i+1)}\epsilon}}\\
}
{
\Delta \vdash (\lambda i:\RangeIncInc{0}{n}.(\String_i,\StringAlt_i),\lambda i:\RangeIncInc{1}{n}.\Atom_i,\sigma) :\\
(\lambda i:\RangeIncInc{1}{n}.\Atom_i,\lambda i:\RangeIncInc{0}{n}.\String_i)\Leftrightarrow
((\lambda i:\RangeIncInc{1}{n}.\AtomAlt_i)\circ \sigma,\lambda i:\RangeIncInc{0}{n}.\StringAlt_i)\\
}

\inferrule[DNF Regex Lens]
{
\Delta \vdash \ClauseLens_i : \Clause_i \Leftrightarrow \ClauseAlt_i\\
\sigma \in \RangeIncInc{1}{n} \rightarrowtail \RangeIncInc{1}{n}\\
i \neq j \Rightarrow \Clause_{i} \cap \Clause_{j}=\emptyset\\
i \neq j \Rightarrow \ClauseAlt_{i} \cap \ClauseAlt_{j}=\emptyset\\
}
{
\Delta \vdash (\lambda i:\RangeIncInc{1}{n}.\ClauseLens_i,\sigma) : (\lambda i:\RangeIncInc{1}{n}.\Clause_i)
\Leftrightarrow (\lambda i:\RangeIncInc{1}{n}.\ClauseAlt_i \circ \sigma)
}
\end{mathpar}
\caption{DNF Lens Typing}
\label{fig:dnf-lens-typing}
\end{figure}
