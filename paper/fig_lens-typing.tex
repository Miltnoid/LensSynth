\begin{figure}
\centering
\begin{mathpar}
\inferrule[Constant Lens]
{
\String_1 \in \Sigma^*\and
\String_2 \in \Sigma^*
}
{
const(\String_1,\String_2) : \String_1 \Leftrightarrow \String_2
}

\inferrule[Identity Lens]
{
}
{
\IdentityLens : \Regex \Leftrightarrow \Regex 
}

\inferrule[Iterate Lens]
{
\Lens : \Regex_1 \Leftrightarrow \Regex_2\and
\Regex_1^{!*}\and
\Regex_2^{!*}
}
{
\IterateLens{\Lens} : \Star{\Regex_1} \Leftrightarrow \Star{\Regex_2}
}

\inferrule[Concat Lens]
{
\Lens_1 : \Regex_{1,1} \Leftrightarrow \Regex_{1,2}\and
\Lens_2 : \Regex_{2,1} \Leftrightarrow \Regex_{2,2}\and
\Regex_{1,1} .! \Regex_{2,1}\and
\Regex_{1,2} .! \Regex_{2,2}
}
{
\ConcatLens{\String_1}{\String_2} : \Regex_{1,1}\Regex_{2,1} \Leftrightarrow \Regex_{1,2}\Regex_{2,2}
}

\inferrule[Swap Lens]
{
\Lens_1 : \Regex_{1,1} \Leftrightarrow \Regex_{1,2} \and
\Lens_2 : \Regex_{2,1} \Leftrightarrow \Regex_{2,2} \and
\Regex_{1,1} .! \Regex_{2,1}\and
\Regex_{2,2} .! \Regex_{1,2}
}
{
\ConcatLens{\String_1}{\String_2} : \Regex_{1,1}\Regex_{2,1} \Leftrightarrow \Regex_{2,2}\Regex_{1,2}
}

\inferrule[Or Lens]
{
\Lens_1 : \Regex_{1,1} \Leftrightarrow \Regex_{1,2}\\
\Lens_2 : \Regex_{2,1} \Leftrightarrow \Regex_{2,2}\\
\Regex_{1,1} \cap \Regex_{2,1} = \emptyset\\
\Regex_{1,2} \cap \Regex_{2,2} = \emptyset\\
}
{
\OrLens{\Lens_1}{\Lens_2} : \Regex_{1,1} | \Regex_{2,1} \Leftrightarrow \Regex_{1,2} | \Regex_{2,2}
}

\inferrule[Compose Lens]
{
\Lens_1 : \Regex_1 \Leftrightarrow \Regex_2 \and
\Lens_2 : \Regex_2 \Leftrightarrow \Regex_3 
}
{
\ComposeLens{\Lens_2}{\Lens_1} : \Regex_1 \Leftrightarrow \Regex_3
}

\inferrule[Retype Lens]
{
\Lens : \Regex_1 \Leftrightarrow \Regex_2 \and
\LanguageOf{\Regex_1} \equiv \LanguageOf{\Regex_1'}\and
\LanguageOf{\Regex_2} \equiv \LanguageOf{\Regex_2'}
}
{
\Lens : \Regex_1' \Leftrightarrow \Regex_2' 
}
\end{mathpar}
\caption{Lens Typing}
\label{fig:lens-typing}
\end{figure}
