\begin{figure}
\centering
\begin{mathpar}
\inferrule[Constant Lens]
{
\String_1 \in \Sigma^*\and
\String_2 \in \Sigma^*
}
{
\Delta \vdash const(\String_1,\String_2) : \String_1 \Leftrightarrow \String_2
}

\inferrule[Identity Lens]
{
}
{
\Delta \vdash \IdentityLens : \Regex \Leftrightarrow \Regex 
}

\inferrule[Iterate Lens]
{
\Delta \vdash \Lens : \Regex_1 \Leftrightarrow \Regex_2\and
\UnambigIt{\LanguageOf{\Delta}{\Regex_1}}\and
\UnambigIt{\LanguageOf{\Delta}{\Regex_2}}
}
{
\Delta \vdash \IterateLens{\Lens} : \Star{\Regex_1} \Leftrightarrow \Star{\Regex_2}
}

\inferrule[Concat Lens]
{
\Delta \vdash \Lens_1 : \Regex_1 \Leftrightarrow \RegexAlt_1\\
\Delta \vdash \Lens_2 : \Regex_2 \Leftrightarrow \RegexAlt_2\\\\
\UnambigConcat{\LanguageOf{\Delta}{\Regex_1}}{\LanguageOf{\Delta}{\Regex_2}}\\
\UnambigConcat{\LanguageOf{\Delta}{\RegexAlt_1}}{\LanguageOf{\Delta}{\RegexAlt_2}}
}
{
\Delta \vdash \ConcatLens{\Lens_1}{\Lens_2} : \Regex_1\Regex_2 \Leftrightarrow \RegexAlt_1\RegexAlt_2
}

\inferrule[Swap Lens]
{
\Delta \vdash \Lens_1 : \Regex_1 \Leftrightarrow \RegexAlt_1\\
\Delta \vdash \Lens_2 : \Regex_2 \Leftrightarrow \RegexAlt_2\\\\
\UnambigConcat{\LanguageOf{\Delta}{\Regex_1}}{\LanguageOf{\Delta}{\Regex_2}}\\
\UnambigConcat{\LanguageOf{\Delta}{\RegexAlt_2}}{\LanguageOf{\Delta}{\RegexAlt_1}}
}
{
\Delta \vdash \ConcatLens{\Lens_1}{\Lens_2} : \Regex_1\Regex_2 \Leftrightarrow \RegexAlt_2\RegexAlt_1
}

\inferrule[Or Lens]
{
\Delta \vdash \Lens_1 : \Regex_1 \Leftrightarrow \RegexAlt_1\\
\Delta \vdash \Lens_2 : \Regex_2 \Leftrightarrow \RegexAlt_2\\\\
\UnambigOr{\LanguageOf{\Delta}{\Regex_1}}{\LanguageOf{\Delta}{\Regex_2}}\\
\UnambigOr{\LanguageOf{\Delta}{\RegexAlt_1}}{\LanguageOf{\Delta}{\RegexAlt_2}}
}
{
\Delta \vdash \OrLens{\Lens_1}{\Lens_2} : \Regex_1 | \RegexAlt_1 \Leftrightarrow \Regex_2 | \RegexAlt_2
}

\inferrule[Compose Lens]
{
\Delta \vdash \Lens_1 : \Regex_1 \Leftrightarrow \Regex_2\\
\Delta \vdash \Lens_2 : \Regex_2 \Leftrightarrow \Regex_3 
}
{
\Delta \vdash \ComposeLens{\Lens_2}{\Lens_1} : \Regex_1 \Leftrightarrow \Regex_3
}

\inferrule[Retype Lens]
{
\Delta \vdash \Lens : \Regex_1 \Leftrightarrow \Regex_2\\
\LanguageOf{\Delta}{\Regex_1} = \LanguageOf{\Delta}{\Regex_1'}\\
\LanguageOf{\Delta}{\Regex_2} = \LanguageOf{\Delta}{\Regex_2'}
}
{
\Delta \vdash \Lens : \Regex_1' \Leftrightarrow \Regex_2' 
}
\end{mathpar}
\caption{Lens Typing}
\label{fig:lens-typing}
\end{figure}
